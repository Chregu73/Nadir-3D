; Form Designer for PureBasic - 6.21
; Warning: this file uses a strict syntax, if you edit it, make sure to respect the Form Designer limitation or it won't be opened again.

;
; This code is automatically generated by the Form Designer.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures need to be put in another source file.
;

Global WindowScanner

Global xAchse, yAchse, zAchse, AP_Homing, APt, APx, APy, APz, ASAt, ASAx, ASAy, ASAz, ASA_AaPu, ASAs, ESAt, ESAx, ESAy, ESAz, ESA_AaPu, ESAs, SAx, SAy, SAz, SA1, SAS, SAt, SA2, SA5, SA10, ASA_Hf, ESA_Hf, GSAt, GSAx, GSAy, GSAz, ASPt, ASPs, EZt, EZs, ScVt, ScVc, SpVt, SpVc, DNt, DNs, DNoe, OSx, OSy, OSz, OSS, OSt, OS_AaPu, SFerz, VAFc, AP_Scan, mGs, mBs, mGt, mBt, mGe, mBe, mGx, mBx, mGy, mBy, mGz, mBz, ARFc, ARFt, GESt, EMPFt, EMPFs, Str1Send, GESs, Str1Txt, Str2Send, Str2Txt, Str3Send, Str3Txt, IvSt, MZbESAf, AP_Hf, mGe_Sp, mB_Sp, EsA, Mof, HvS, MaS

Global Img_WindowScanner_0, Img_WindowScanner_1, Img_WindowScanner_2, Img_WindowScanner_3, Img_WindowScanner_4, Img_WindowScanner_5, Img_WindowScanner_6

Enumeration FormMenu
  #Laden
  #Speichern
  #Beenden
  #SerielleSchnittstelle
  #Hilfe
  #GCodes
  #Ueber
EndEnumeration

Img_WindowScanner_0 = LoadImage(#PB_Any,"Icons\Help.ico")
Img_WindowScanner_1 = LoadImage(#PB_Any,"Icons\Info.ico")
Img_WindowScanner_2 = LoadImage(#PB_Any,"Icons\Settings.ico")
Img_WindowScanner_3 = LoadImage(#PB_Any,"Icons\Open.ico")
Img_WindowScanner_4 = LoadImage(#PB_Any,"Icons\Save.ico")
Img_WindowScanner_5 = LoadImage(#PB_Any,"Icons\LogOut.ico")
Img_WindowScanner_6 = LoadImage(#PB_Any,"Icons\Emey87-Social-Button-G.ico")

Declare Beenden(Event)
Declare Ueber(Event)
Declare manual(Event)
Declare gcodes(Event)
Declare SerialSettings(Event)
Declare MotorenAbschalten(EventType)
Declare maxBeschlEinstellen(EventType)
Declare Homing(EventType)
Declare ScanAufloesung050(EventType)
Declare ASAausAktPos(EventType)
Declare Auf(EventType)
Declare ScanAufloesung020(EventType)
Declare ScanAufloesung100(EventType)
Declare EndschalterAbfragen(EventType)
Declare individuellerString3Senden(EventType)
Declare ScanVonForm(EventType)
Declare FahrenNachAktuellePosition(EventType)
Declare individuellerString2Senden(EventType)
Declare FahrenNachAnfangScanArea(EventType)
Declare Oeffnen(EventType)
Declare ESAausAktPos(EventType)
Declare FahrenNachEndeScanArea(EventType)
Declare ScanAufloesung010(EventType)
Declare maxGeschwEinstellen(EventType)
Declare individuellerString1Senden(EventType)
Declare ErzeugeSCAD(EventType)

Procedure OpenWindowScanner(x = 0, y = 0, width = 736, height = 624)
  WindowScanner = OpenWindow(#PB_Any, x, y, width, height, "Nadir 3D", #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_ScreenCentered | #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_ScreenCentered)
  AddKeyboardShortcut(WindowScanner, #PB_Shortcut_F1, #Hilfe)

  CreateStatusBar(0, WindowID(WindowScanner))
  AddStatusBarField(70)
  StatusBarText(0, 0, "Fortschritt:", #PB_StatusBar_Raised)
  AddStatusBarField(200)
  StatusBarProgress(0, 1, 0)
  AddStatusBarField(300)
  CreateImageMenu(0, WindowID(WindowScanner))
  MenuTitle("Datei")
  MenuItem(#Laden, "Laden", ImageID(Img_WindowScanner_3))
  MenuItem(#Speichern, "Speichern", ImageID(Img_WindowScanner_4))
  MenuItem(#Beenden, "Beenden", ImageID(Img_WindowScanner_5))
  MenuTitle("Einstellungen")
  MenuItem(#SerielleSchnittstelle, "serielle Schnittstelle", ImageID(Img_WindowScanner_2))
  MenuTitle("Hilfe")
  MenuItem(#Hilfe, "Hilfe..." + Chr(9) + "F1", ImageID(Img_WindowScanner_0))
  MenuItem(#GCodes, "G-Codes", ImageID(Img_WindowScanner_6))
  MenuItem(#Ueber, "Über", ImageID(Img_WindowScanner_1))
  xAchse = TextGadget(#PB_Any, 128, 64, 48, 20, "X-Achse:")
  yAchse = TextGadget(#PB_Any, 200, 64, 48, 20, "Y-Achse:")
  zAchse = TextGadget(#PB_Any, 272, 64, 48, 20, "Z-Achse:")
  AP_Homing = ButtonGadget(#PB_Any, 352, 88, 56, 20, "Homing")
  APt = TextGadget(#PB_Any, 16, 88, 104, 20, "Aktuelle Position:")
  APx = StringGadget(#PB_Any, 128, 88, 64, 20, "n/a")
  APy = StringGadget(#PB_Any, 200, 88, 64, 20, "n/a")
  APz = StringGadget(#PB_Any, 272, 88, 64, 20, "n/a")
  ASAt = TextGadget(#PB_Any, 16, 112, 104, 20, "Anfang Scan-Area:")
  ASAx = StringGadget(#PB_Any, 128, 112, 64, 20, "30.00")
  ASAy = StringGadget(#PB_Any, 200, 112, 64, 20, "30.00")
  ASAz = StringGadget(#PB_Any, 272, 112, 64, 20, "0.00")
  ASA_AaPu = ButtonGadget(#PB_Any, 352, 112, 200, 20, "Aus aktueller Position übernehmen")
  ASAs = ButtonGadget(#PB_Any, 560, 112, 64, 20, "Speichern")
  DisableGadget(ASAs, 1)
  ESAt = TextGadget(#PB_Any, 16, 136, 104, 20, "Ende Scan-Area:")
  ESAx = StringGadget(#PB_Any, 128, 136, 64, 20, "31.00")
  ESAy = StringGadget(#PB_Any, 200, 136, 64, 20, "31.00")
  ESAz = StringGadget(#PB_Any, 272, 136, 64, 20, "1.00")
  ESA_AaPu = ButtonGadget(#PB_Any, 352, 136, 200, 20, "Aus aktueller Position übernehmen")
  ESAs = ButtonGadget(#PB_Any, 560, 136, 64, 20, "Speichern")
  DisableGadget(ESAs, 1)
  SAx = StringGadget(#PB_Any, 128, 184, 64, 20, "0.10")
  SAy = StringGadget(#PB_Any, 200, 184, 64, 20, "0.10")
  SAz = StringGadget(#PB_Any, 272, 184, 64, 20, "0.10")
  SA1 = ButtonGadget(#PB_Any, 352, 184, 56, 20, "0.10mm")
  SAS = ButtonGadget(#PB_Any, 608, 184, 64, 20, "Speichern")
  DisableGadget(SAS, 1)
  SAt = TextGadget(#PB_Any, 16, 184, 104, 20, "Scan-Auflösung:")
  SA2 = ButtonGadget(#PB_Any, 416, 184, 56, 20, "0.20mm")
  SA5 = ButtonGadget(#PB_Any, 480, 184, 56, 20, "0.50mm")
  SA10 = ButtonGadget(#PB_Any, 544, 184, 56, 20, "1.00mm")
  ASA_Hf = ButtonGadget(#PB_Any, 632, 112, 88, 20, "Hierher fahren")
  ESA_Hf = ButtonGadget(#PB_Any, 632, 136, 88, 20, "Hierher fahren")
  GSAt = TextGadget(#PB_Any, 16, 160, 104, 20, "Grösse Scan-Area:")
  GSAx = StringGadget(#PB_Any, 128, 160, 64, 20, "1.00", #PB_String_ReadOnly)
  GSAy = StringGadget(#PB_Any, 200, 160, 64, 20, "1.00", #PB_String_ReadOnly)
  GSAz = StringGadget(#PB_Any, 272, 160, 64, 20, "1.00", #PB_String_ReadOnly)
  ASPt = TextGadget(#PB_Any, 16, 280, 112, 20, "Anzahl Scan-Punkte:")
  ASPs = StringGadget(#PB_Any, 168, 280, 96, 20, "100", #PB_String_Numeric | #PB_String_ReadOnly)
  EZt = TextGadget(#PB_Any, 16, 304, 144, 20, "Erwartete Zeit [hh:mm:ss]:")
  EZs = StringGadget(#PB_Any, 168, 304, 96, 20, "00:17:00", #PB_String_Numeric | #PB_String_ReadOnly)
  ScVt = TextGadget(#PB_Any, 352, 304, 112, 20, "Scan-Verfahren:")
  ScVc = ComboBoxGadget(#PB_Any, 472, 304, 246, 20)
  SpVt = TextGadget(#PB_Any, 352, 352, 112, 20, "Speicher-Verfahren:")
  SpVc = ComboBoxGadget(#PB_Any, 472, 352, 246, 20)
  DNt = TextGadget(#PB_Any, 16, 384, 104, 20, "Dateiname:")
  DNs = StringGadget(#PB_Any, 128, 384, 376, 20, "surface.dat")
  DNoe = ButtonGadget(#PB_Any, 512, 384, 56, 20, "Öffnen")
  OSx = StringGadget(#PB_Any, 128, 208, 64, 20, "0.00")
  DisableGadget(OSx, 1)
  OSy = StringGadget(#PB_Any, 200, 208, 64, 20, "0.00")
  DisableGadget(OSy, 1)
  OSz = StringGadget(#PB_Any, 272, 208, 64, 20, "0.00")
  DisableGadget(OSz, 1)
  OSS = ButtonGadget(#PB_Any, 560, 208, 64, 20, "Speichern")
  DisableGadget(OSS, 1)
  OSt = TextGadget(#PB_Any, 16, 208, 104, 20, "Offset Speichern:")
  OS_AaPu = ButtonGadget(#PB_Any, 352, 208, 200, 20, "Aus aktueller Position übernehmen")
  DisableGadget(OS_AaPu, 1)
  SFerz = ButtonGadget(#PB_Any, 584, 384, 136, 20, "surface.scad erzeugen")
  VAFc = CheckBoxGadget(#PB_Any, 16, 352, 152, 20, "OpenSCAD aktualisieren")
  AP_Scan = ButtonGadget(#PB_Any, 416, 88, 40, 20, "Scan")
  GadgetToolTip(AP_Scan, "Aktuelle Position Scannen")
  mGs = CheckBoxGadget(#PB_Any, 576, 232, 136, 20, "max. Geschw. senden")
  mBs = CheckBoxGadget(#PB_Any, 576, 256, 136, 20, "max. Beschl. senden")
  mGt = TextGadget(#PB_Any, 16, 232, 104, 20, "max. Geschw.:")
  mBt = TextGadget(#PB_Any, 16, 256, 104, 20, "max. Beschl.:")
  mGe = ButtonGadget(#PB_Any, 352, 232, 144, 20, "max. Geschw. einstellen")
  mBe = ButtonGadget(#PB_Any, 352, 256, 144, 20, "max. Beschl. einstellen")
  mGx = StringGadget(#PB_Any, 128, 232, 64, 20, "5.00")
  GadgetToolTip(mGx, "mm/sec")
  mBx = SpinGadget(#PB_Any, 128, 256, 64, 20, 1, 1000, #PB_Spin_Numeric)
  GadgetToolTip(mBx, "mm/s^2")
  mGy = StringGadget(#PB_Any, 200, 232, 64, 20, "5.00")
  GadgetToolTip(mGy, "mm/sec")
  mBy = SpinGadget(#PB_Any, 200, 256, 64, 20, 1, 1000, #PB_Spin_Numeric)
  GadgetToolTip(mBy, "mm/s^2")
  mGz = StringGadget(#PB_Any, 272, 232, 64, 20, "2.50")
  GadgetToolTip(mGz, "mm/sec")
  mBz = SpinGadget(#PB_Any, 272, 256, 64, 20, 1, 1000, #PB_Spin_Numeric)
  GadgetToolTip(mBz, "mm/s^2")
  ARFc = ComboBoxGadget(#PB_Any, 472, 328, 246, 20)
  ARFt = TextGadget(#PB_Any, 352, 328, 112, 20, "Achsenreihenfolge:")
  GESt = TextGadget(#PB_Any, 16, 416, 104, 20, "Gesendet:")
  EMPFt = TextGadget(#PB_Any, 376, 416, 104, 20, "Empfangen:")
  EMPFs = EditorGadget(#PB_Any, 376, 440, 344, 128, #PB_Editor_ReadOnly)
  Str1Send = ButtonGadget(#PB_Any, 304, 496, 56, 20, "Senden")
  GESs = StringGadget(#PB_Any, 16, 440, 344, 20, "", #PB_String_ReadOnly)
  Str1Txt = StringGadget(#PB_Any, 16, 496, 280, 20, "")
  Str2Send = ButtonGadget(#PB_Any, 304, 520, 56, 20, "Senden", #PB_Button_Toggle)
  Str2Txt = StringGadget(#PB_Any, 16, 520, 280, 20, "")
  Str3Send = ButtonGadget(#PB_Any, 304, 544, 56, 20, "Senden")
  Str3Txt = StringGadget(#PB_Any, 16, 544, 280, 20, "")
  IvSt = TextGadget(#PB_Any, 16, 472, 104, 20, "Individueller String:")
  MZbESAf = ButtonGadget(#PB_Any, 464, 88, 160, 20, "Z bis Ende Scan-Area fahren")
  AP_Hf = ButtonGadget(#PB_Any, 632, 88, 88, 20, "Hierher fahren")
  mGe_Sp = ButtonGadget(#PB_Any, 504, 232, 64, 20, "Speichern")
  DisableGadget(mGe_Sp, 1)
  mB_Sp = ButtonGadget(#PB_Any, 504, 256, 64, 20, "Speichern")
  DisableGadget(mB_Sp, 1)
  EsA = ButtonGadget(#PB_Any, 352, 280, 128, 20, "Endschalter abfragen")
  Mof = ButtonGadget(#PB_Any, 488, 280, 120, 20, "Motoren abschalten")
  HvS = CheckBoxGadget(#PB_Any, 16, 328, 120, 20, "Homing vor Scan")
  MaS = CheckBoxGadget(#PB_Any, 168, 328, 120, 20, "Mäander Scan")
  GadgetToolTip(MaS, "Scant im Zick-Zack, spart das Zurückfahren nach jeder Zeile")
EndProcedure

Procedure WindowScanner_Events(event)
  Select event
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
        Case #Laden
        Case #Speichern
        Case #Beenden
          Beenden(EventMenu())
        Case #SerielleSchnittstelle
          SerialSettings(EventMenu())
        Case #Hilfe
          manual(EventMenu())
        Case #GCodes
          gcodes(EventMenu())
        Case #Ueber
          Ueber(EventMenu())
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case AP_Homing
          Homing(EventType())          
        Case ASA_AaPu
          ASAausAktPos(EventType())          
        Case ESA_AaPu
          ESAausAktPos(EventType())          
        Case SA1
          ScanAufloesung010(EventType())          
        Case SA2
          ScanAufloesung020(EventType())          
        Case SA5
          ScanAufloesung050(EventType())          
        Case SA10
          ScanAufloesung100(EventType())          
        Case ASA_Hf
          FahrenNachAnfangScanArea(EventType())          
        Case ESA_Hf
          FahrenNachEndeScanArea(EventType())          
        Case DNoe
          Oeffnen(EventType())          
        Case SFerz
          ErzeugeSCAD(EventType())          
        Case AP_Scan
          ScanVonForm(EventType())          
        Case mGe
          maxGeschwEinstellen(EventType())          
        Case mBe
          maxBeschlEinstellen(EventType())          
        Case Str1Send
          individuellerString1Senden(EventType())          
        Case Str2Send
          individuellerString2Senden(EventType())          
        Case Str3Send
          individuellerString3Senden(EventType())          
        Case MZbESAf
          Auf(EventType())          
        Case AP_Hf
          FahrenNachAktuellePosition(EventType())          
        Case EsA
          EndschalterAbfragen(EventType())          
        Case Mof
          MotorenAbschalten(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure

